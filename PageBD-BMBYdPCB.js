import{d as ee,v as O,a as r,c as v,w as t,Q as $e,a0 as _e,a1 as ye,q as he,n as ve,r as h,s as C,b as e,h as ge,V as xe,e as V,t as B,f as a,aa as G,i as g,l as fe,B as Me,C as Y,z as re,bi as Z,bw as le,a8 as ce,bx as Re,F as $,A as F,m as R,ab as Be,க as pe,M as De,by as He,bz as Je,a9 as je,bA as Ke,bB as Xe,ag as qe,aF as Ye,bC as Ze,a4 as me,Y as y,a6 as Ae,bD as ea,E as aa,bE as ta,a7 as oe,bF as ze,x as N,u as ia,ம as la,o as na,bG as oa,ax as sa,au as da,bH as ua,aQ as ra,aR as ca,aS as Ee,aT as ma,bn as Se,bI as fa,bo as va,bJ as Ie,N as ne,bK as pa,bL as ba,bM as _a,J as ya,bN as ga,bp as Ne,bO as xa,bq as Ba,a5 as we,bP as Te,af as Ca,aV as ka,aU as Le,at as Va,a2 as wa,aW as Pe,a3 as Ta}from"./index-BQ50ekR7.js";import{u as ja}from"./historiqueDocuments-CwKO0l6R.js";import{_ as $a,t as ha,E as Da,a as Aa,V as Ea,b as Fe,c as Qe,d as Sa,e as Ia,f as Na,g as La,h as Pa,i as Ua,j as Oa,k as Ma,l as Ra,m as qa}from"./VBreadcrumbs-BlK8NlZC.js";import{V as za,a as Ue}from"./VTabs-BWQ4GpUO.js";import{V as Oe}from"./VSlideGroupItem-DJM0jdQb.js";import"./ItemAutomatisation.vue_vue_type_script_setup_true_lang-C0hgMXiY.js";import"./RésultatRechercheProjet.vue_vue_type_script_setup_true_lang-BCsSLHCc.js";import"./CarteProjet.vue_vue_type_script_setup_true_lang-BNIaZPVK.js";import"./NouveauProjet.vue_vue_type_script_setup_true_lang-Clentbvm.js";const Fa=ee({__name:"CarteCodeBd",props:{id:{}},setup(I){const u=I,s=O(()=>({ts:`import { créerConstellation } from "@constl/ipa";

const client = créerConstellation();

const monAnalyse = async (données) => {
  console.log(données)
  // Faire quelque chose...
}

const fOublier = client.bds.suivreDonnéesExportation({
  idBd: "${u.id}",
  f: monAnalyse
})
`,py:`from constellationPy import Serveur, ClientSync
    
with Serveur():
    client = ClientSync()

    données = client.bds.suivreDonnéesExportation(
      idBd="${u.id}"
    )
`,julia:`import Constellation

Constellation.avecServeur() do port
  Constellation.avecClient(port) do client

    oublier = Constellation.suivre(
        client, 
        "bds.suivreDonnéesExportation", 
        Dict([("idBd","${u.id}")])
    ) do résultat
        print(résultat)
    end
  end
end
`,r:`library(constellationR)

constellationR::avecClientEtServeur(
  function (client) {
    
    données <- client$appeler(
      "bds.suivreDonnéesExportation", 
      list(idBd="${u.id}")
    )
  }
)
`}));return(f,b)=>(r(),v($a,{codes:s.value},{activator:t(({props:x})=>[$e(f.$slots,"activator",_e(ye({props:x})))]),_:3},8,["codes"]))}}),Qa=ee({__name:"CarteQualitéBd",props:{idBd:{}},setup(I){const{mdAndUp:u}=he(),{மொழியாக்கம்_பயன்படுத்து:s}=pe(),{$மொ:f}=s(),b=I,x=ve(),d=h(!1),_=C(x.bds.suivreQualitéBd,{idBd:b.idBd}),D=C(x.bds.suivreLicenceBd,{idBd:b.idBd}),q=C(x.bds.suivreLicenceContenuBd,{idBd:b.idBd}),z=C(x.suivrePermission,{idObjet:b.idBd});return(w,T)=>(r(),v(Be,{modelValue:d.value,"onUpdate:modelValue":T[1]||(T[1]=j=>d.value=j),"max-width":a(u)?500:300},{activator:t(({props:j})=>[$e(w.$slots,"activator",_e(ye({props:j})))]),default:t(()=>[e(R,null,{default:t(()=>[e(ge,null,{default:t(()=>[e(xe,{class:"d-flex"},{default:t(()=>[V(B(a(f)("bds.qualité.titre"))+" ",1),e(G),e(g,{icon:"mdi-close",size:"small",variant:"flat",onClick:T[0]||(T[0]=j=>d.value=!1)})]),_:1})]),_:1}),e(fe,null,{default:t(()=>[e(Me,null,{default:t(()=>[e(Y,null,{prepend:t(()=>[e(re,null,{default:t(()=>[e(Z,{"model-value":(a(_)?.total||0)*100,width:5,indeterminate:a(_)?.total===void 0,color:a(le)(a(_)?.total).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>T[2]||(T[2]=[V("Score total")])),_:1}),e(ce),e(Y,null,{prepend:t(()=>[e(re,null,{default:t(()=>[e(Z,{"model-value":(a(_)?.accès||0)*100,width:5,indeterminate:a(_)?.accès===void 0,color:a(le)(a(_)?.accès).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>T[3]||(T[3]=[V("Accessibilité")])),_:1}),e(Re,{licence:a(D),"licence-contenu":a(q),"permission-modifier":!!a(z)},{activator:t(({props:j})=>[e(Y,_e(ye(j)),{prepend:t(()=>[e(re,null,{default:t(()=>[a(_)?.licence===void 0?(r(),v(Z,{key:0,width:5,indeterminate:"",color:a(le)(a(_)?.licence).couleur},null,8,["color"])):$("",!0),e(F,{icon:a(_)?.licence?"mdi-check":"mdi-alert-circle-outline",color:a(le)(a(_)?.licence).couleur},null,8,["icon","color"])]),_:1})]),title:t(()=>[V(B(a(_)?.licence===void 0?a(f)("bds.qualité.rechercheLicence"):a(_).licence?a(f)("bds.qualité.licenceOuverte"):a(f)("bds.qualité.licenceNonReconnue")),1)]),_:2},1040)]),_:1},8,["licence","licence-contenu","permission-modifier"]),e(Y,null,{prepend:t(()=>[e(re,null,{default:t(()=>[e(Z,{"model-value":(a(_)?.valide||0)*100,width:5,indeterminate:a(_)?.valide===void 0,color:a(le)(a(_)?.valide).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>T[4]||(T[4]=[V("Validation données")])),_:1}),e(Y,null,{prepend:t(()=>[e(re,null,{default:t(()=>[e(Z,{"model-value":(a(_)?.couverture||0)*100,width:5,indeterminate:a(_)?.couverture===void 0,color:a(le)(a(_)?.couverture).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>T[5]||(T[5]=[V("Couverture tests")])),_:1})]),_:1})]),_:1})]),_:1})]),_:3},8,["modelValue","max-width"]))}}),Ga=ee({__name:"CarteStatutBd",props:{idBd:{}},setup(I){const u=I,{மொழியாக்கம்_பயன்படுத்து:s}=pe(),{$மொ:f}=s(),{mdAndUp:b}=he(),x=ve(),d=h(!1),_=C(x.bds.suivreStatutBd,{idBd:u.idBd}),D=h();De(()=>{D.value=_.value});const q=O(()=>_.value?.statut!==D.value?.statut||_.value?.idNouvelle!==D.value?.idNouvelle),z=h(!1),w=async()=>{z.value=!0,D.value&&await x.bds.changerStatutBd({idBd:u.idBd,statut:D.value}),z.value=!1,d.value=!1};return(T,j)=>(r(),v(Be,{modelValue:d.value,"onUpdate:modelValue":j[2]||(j[2]=E=>d.value=E)},{activator:t(({props:E})=>[$e(T.$slots,"activator",_e(ye({props:E})))]),default:t(()=>[e(R,{class:"mx-auto","min-width":a(b)?500:300},{default:t(()=>[e(ge,null,{default:t(()=>[e(xe,null,{default:t(()=>[V(B(a(f)("bds.statut.carte.titre")),1)]),_:1})]),_:1}),e(fe,null,{default:t(()=>[e(He,{initial:D.value,onChoisir:j[0]||(j[0]=E=>D.value=E)},{sélecteur:t(({choisirNouvelle:E})=>[e(Je,{multiples:!1,onSelectionnee:W=>E(W[0])},null,8,["onSelectionnee"])]),_:1},8,["initial"])]),_:1}),e(je,null,{default:t(()=>[e(G),e(g,{disabled:!q.value,loading:z.value,variant:"flat",color:"primary",onClick:w},{default:t(()=>[V(B(a(f)("communs.sauvegarder")),1)]),_:1},8,["disabled","loading"]),e(g,{variant:"flat","append-icon":"mdi-close",onClick:j[1]||(j[1]=E=>d.value=!1)},{default:t(()=>[V(B(a(f)("communs.fermer")),1)]),_:1})]),_:1})]),_:1},8,["min-width"])]),_:3},8,["modelValue"]))}}),Wa=ee({__name:"ItemQualitéBd",props:{id:{}},setup(I){return(u,s)=>(r(),v(Y,null,{prepend:t(()=>[e(Ke,{id:u.id},null,8,["id"])]),default:t(()=>[e(qe,null,{default:t(()=>[e(Xe,{id:u.id},null,8,["id"])]),_:1})]),_:1}))}}),Ha=ee({__name:"ItemLicence",props:{licence:{}},setup(I){const u=ve(),{மொழியாக்கம்_பயன்படுத்து:s}=pe(),{$மொ:f}=s(),b=I,x=C(u.licences.suivreLicences),d=O(()=>b.licence&&x.value&&Object.keys(x.value).includes(b.licence));return(_,D)=>(r(),v(Y,null,{prepend:t(()=>[e(F,{start:"",color:d.value?"primary":"error"},{default:t(()=>[V(B(d.value?"mdi-scale-balance":"mdi-alert"),1)]),_:1},8,["color"])]),default:t(()=>[e(qe,null,{default:t(()=>[V(B(d.value?a(f)(`licences.info.${_.licence}.abr`):_.licence),1)]),_:1})]),_:1}))}}),Ja={class:"my-4 text-h6 text-disabled"},Ka=ee({__name:"TableauBd",props:{idTableau:{},idBd:{}},setup(I){const{மொழியாக்கம்_பயன்படுத்து:u}=pe(),{$மொ:s}=u(),f=ve(),b=I,x=C(f.suivrePermission,{idObjet:b.idTableau}),d=C(f.tableaux.suivreVariables,{idTableau:b.idTableau}),_=C(f.tableaux.suivreColonnesTableau,{idTableau:b.idTableau}),D=C(f.tableaux.suivreColonnesTableau,{idTableau:b.idTableau,catégories:!0}),q=O(()=>(_.value||[]).map(l=>{const o=D.value?.find(n=>n.id===l.id)?.catégorie;return{key:l.id,sortable:o===void 0||(o?.type==="simple"?ha(o.catégorie):!1),info:{index:l.index,catégorie:o,variable:l.variable}}})),z=O(()=>{const l={key:"actions",sortable:!1,info:{}};return[...q.value,l]}),w=async({idVariable:l,idColonne:o,index:n,règles:m})=>{o=await f.tableaux.ajouterColonneTableau({idTableau:b.idTableau,idVariable:l,idColonne:o}),n&&await f.tableaux.changerColIndex({idTableau:b.idTableau,idColonne:o,val:!0});for(const k of m)await f.tableaux.ajouterRègleTableau({idTableau:b.idTableau,idColonne:o,règle:k})},T=async({idColonne:l,index:o,règles:n})=>{await f.tableaux.changerColIndex({idTableau:b.idTableau,idColonne:l,val:o});for(const m of n.nouvelles)await f.tableaux.ajouterRègleTableau({idTableau:b.idTableau,idColonne:l,règle:m});for(const m of n.àEffacer)await f.tableaux.effacerRègleTableau({idTableau:b.idTableau,idRègle:m})},j=async({idColonne:l})=>{await f.tableaux.effacerColonneTableau({idTableau:b.idTableau,idColonne:l})},E=C(f.tableaux.suivreDonnées,{idTableau:b.idTableau}),W=O(()=>{const l=E.value?.toSorted((n,m)=>ae.value&&ae.value.map(k=>n.données[k.key]===void 0?m.données[k.key]===void 0?0:k.order==="asc"?1:-1:m.données[k.key]===void 0?n.données[k.key]===void 0?0:k.order==="asc"?-1:1:n.données[k.key]>m.données[k.key]?k.order==="asc"?1:-1:n.données[k.key]<m.données[k.key]?k.order==="asc"?-1:1:0).find(k=>k!==0)||0),o={id:"-1",données:{}};return H.value&&l?[o,...l]:l}),ae=h(),M=h([]),Ce=C(f.tableaux.suivreRègles,{idTableau:b.idTableau}),H=h(!1),be=h(!1),Q=h(),se=O(()=>{const l=[];for(const[o,n]of Object.entries(Q.value||{})){const m=E.value?.find(k=>k.id===o);m&&ke({modifs:n,original:m.données})&&l.push({idÉlément:o,vals:n})}return l}),L=O(()=>se.value.length+(Object.keys(A.value).length?1:0)),ke=({modifs:l,original:o})=>Object.keys(l).some(n=>o[n]!==l[n]),A=h({});De(()=>{H.value||(A.value={})});const te=O(()=>Object.keys(A.value).length>0),S=({val:l,idCol:o,idÉlément:n})=>{if(n==="-1")l!==void 0?A.value[o]=l:delete A.value[o];else{const m=Q.value||{};m[n]||(m[n]={}),m[n][o]=l,Q.value=m}},P=async({vals:l})=>Object.fromEntries(await Promise.all(Object.entries(l).map(async([o,n])=>{if(n instanceof File){const m=await f.ajouterÀSFIP({contenu:new Uint8Array(await n.arrayBuffer()),nomFichier:n.name});return[o,m]}else return[o,n]}))),de=async()=>{be.value=!0;for(const{idÉlément:l,vals:o}of se.value)await f.tableaux.modifierÉlément({idTableau:b.idTableau,idÉlément:l,vals:await P({vals:o})});te.value&&await ue(),Q.value=void 0,be.value=!1},ue=async()=>{await f.tableaux.ajouterÉlément({idTableau:b.idTableau,vals:await P({vals:A.value})}),A.value={}},ie=h(!1),J=h(!1),U=h(!1),K=h(!1),X=h(!1);Ye([K,X],()=>{ie.value=J.value});const c=async({idÉlément:l})=>{U.value=!0,await f.tableaux.effacerÉlément({idTableau:b.idTableau,idÉlément:l}),U.value=!1},p=async()=>{U.value=!0,await Promise.all(M.value.map(l=>c({idÉlément:l}))),M.value=[],U.value=!1},i=async()=>{await f.bds.effacerTableauBd({idBd:b.idBd,idTableau:b.idTableau})};return(l,o)=>(r(),v(Ia,{modelValue:M.value,"onUpdate:modelValue":o[13]||(o[13]=n=>M.value=n),headers:z.value,items:W.value,"show-select":!!a(x),"multi-sort":"","onUpdate:sortBy":o[14]||(o[14]=n=>ae.value=n)},Ze({top:t(()=>[e(Ea,{flat:"",density:"compact"},{default:t(()=>[e(G),a(x)?(r(),v(g,{key:0,icon:"",disabled:!L.value,onClick:o[0]||(o[0]=()=>de())},{default:t(()=>[L.value?(r(),v(ea,{key:0,color:"success",content:L.value},{default:t(()=>[e(F,{color:"primary",icon:"mdi-content-save-outline"})]),_:1},8,["content"])):(r(),v(F,{key:1,color:"primary",icon:"mdi-content-save-check-outline"}))]),_:1},8,["disabled"])):$("",!0),a(x)?(r(),v(aa,{key:1,modelValue:H.value,"onUpdate:modelValue":o[1]||(o[1]=n=>H.value=n),class:"me-4",density:"compact",color:"primary","true-icon":"mdi-pencil-outline","false-icon":"mdi-pencil-off-outline","hide-details":""},null,8,["modelValue"])):$("",!0),a(x)?(r(),v(ta,{key:2,"id-tableau":l.idTableau,"variables-interdites":a(d),onNouvelle:o[2]||(o[2]=n=>w(n))},{activator:t(({props:n})=>[e(g,y(n,{icon:"mdi-table-column-plus-after"}),null,16)]),_:1},8,["id-tableau","variables-interdites"])):$("",!0),e(Fe,{"id-objet":l.idTableau,"type-objet":"tableau"},{activator:t(({props:n})=>[e(oe,{text:a(s)("exportations.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:m})=>[e(g,y({...n,...m},{icon:"mdi-sync"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id-objet"]),e(Qe,{"id-objet":l.idTableau,"type-objet":"tableau"},{activator:t(({props:n})=>[e(oe,{text:a(s)("exportations.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:m})=>[e(g,y({...n,...m},{icon:"mdi-download"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id-objet"]),a(x)?(r(),v(ze,{key:3,onEffacer:o[3]||(o[3]=()=>i())},{activator:t(({props:n})=>[e(g,y(n,{icon:"mdi-delete",color:"error"}),null,16)]),_:1})):$("",!0)]),_:1})]),"no-data":t(()=>[N("p",Ja,B(a(s)("tableaux.aucuneDonnée")),1),e(Sa,{type:"importation","info-objet":{id:l.idTableau,typeObjet:"tableau"},"id-tableau":l.idTableau,"colonnes-tableau":a(_)||[]},{activator:t(({props:n})=>[e(g,y(n,{class:"mb-4","prepend-icon":"mdi-import",variant:"outlined"}),{default:t(()=>[V(B(a(s)("tableaux.importer")),1)]),_:2},1040)]),_:1},8,["info-objet","id-tableau","colonnes-tableau"])]),"item.actions":t(({item:n})=>[n.id==="-1"?(r(),v(g,{key:0,disabled:!te.value,icon:"mdi-content-save-outline",size:"small",variant:"flat",onClick:o[9]||(o[9]=()=>ue())},null,8,["disabled"])):ie.value&&a(x)?(r(),v(g,{key:1,size:"small",icon:"mdi-delete",variant:"flat",loading:U.value,onClick:()=>c({idÉlément:n.id})},null,8,["loading","onClick"])):a(x)?(r(),v(Be,{key:2,modelValue:K.value,"onUpdate:modelValue":o[12]||(o[12]=m=>K.value=m)},{activator:t(({props:m})=>[e(g,y(m,{variant:"flat",icon:"mdi-delete",size:"small",loading:U.value}),null,16,["loading"])]),default:t(()=>[e(R,{class:"mx-auto","max-width":"450"},{default:t(()=>[e(ge,null,{default:t(()=>[e(xe,null,{default:t(()=>[V(B(a(s)("tableaux.données.titreEffacer")),1)]),_:1})]),_:1}),e(fe,null,{default:t(()=>[e(Ae,{modelValue:J.value,"onUpdate:modelValue":o[10]||(o[10]=m=>J.value=m),label:a(s)("tableaux.données.nePlusConfirmerEffacer")},null,8,["modelValue","label"])]),_:1}),e(je,null,{default:t(()=>[e(G),e(g,{variant:"text",text:a(s)("communs.oui"),onClick:()=>{c({idÉlément:n.id}),K.value=!1}},null,8,["text","onClick"]),e(g,{variant:"text",color:"primary",text:a(s)("communs.non"),onClick:o[11]||(o[11]=m=>K.value=!1)},null,8,["text"]),e(G)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])):$("",!0)]),_:2},[me(q.value||[],n=>({name:`header.${n.key}`,fn:t(({column:m,isSorted:k,getSortIcon:Ge,toggleSort:We})=>[e(Da,{"id-colonne":n.key,"id-variable":n.info.variable,"id-tableau":l.idTableau,index:!!n.info.index,regles:a(Ce)?.filter(Ve=>Ve.colonne===n.key),"permission-modifier":!!a(x),ordonnable:m.sortable,"est-ordonnee":k(m),"icone-ordonner":Ge(m),onBasculerOrdonner:()=>We(m),onSauvegarder:Ve=>T({idColonne:n.key,...Ve}),onEffacer:()=>j({idColonne:n.key})},null,8,["id-colonne","id-variable","id-tableau","index","regles","permission-modifier","ordonnable","est-ordonnee","icone-ordonner","onBasculerOrdonner","onSauvegarder","onEffacer"])])})),a(x)?{name:"header.actions",fn:t(()=>[ie.value?(r(),v(g,{key:0,icon:"mdi-delete",variant:"flat",size:"small",loading:U.value,readonly:!M.value.length,onClick:o[4]||(o[4]=()=>p())},null,8,["loading","readonly"])):(r(),v(Be,{key:1,modelValue:X.value,"onUpdate:modelValue":o[8]||(o[8]=n=>X.value=n)},{activator:t(({props:n})=>[e(g,y(n,{icon:"",variant:"flat",size:"small",readonly:!M.value.length,loading:U.value}),{default:t(()=>[e(F,{icon:"mdi-delete",color:M.value.length?void 0:"disabled"},null,8,["color"])]),_:2},1040,["readonly","loading"])]),default:t(()=>[e(R,{class:"mx-auto","max-width":"450"},{default:t(()=>[e(ge,null,{default:t(()=>[e(xe,null,{default:t(()=>[V(B(a(s)("tableaux.données.titreEffacerSélectionnées",M.value.length)),1)]),_:1})]),_:1}),e(fe,null,{default:t(()=>[e(Ae,{modelValue:J.value,"onUpdate:modelValue":o[5]||(o[5]=n=>J.value=n),label:a(s)("tableaux.données.nePlusConfirmerEffacer")},null,8,["modelValue","label"])]),_:1}),e(je,null,{default:t(()=>[e(G),e(g,{variant:"text",text:a(s)("communs.oui"),onClick:o[6]||(o[6]=()=>{p(),X.value=!1})},null,8,["text"]),e(g,{variant:"text",color:"primary",text:a(s)("communs.non"),onClick:o[7]||(o[7]=n=>X.value=!1)},null,8,["text"]),e(G)]),_:1})]),_:1})]),_:1},8,["modelValue"]))]),key:"0"}:void 0,me(q.value,n=>({name:`item.${n.key}`,fn:t(({item:m})=>[e(Aa,{categorie:n.info.catégorie?.catégorie,val:m.données[n.key],editable:!!a(x)&&H.value,onModifiee:({val:k})=>S({idCol:n.key,idÉlément:m.id,val:k})},null,8,["categorie","val","editable","onModifiee"])])}))]),1032,["modelValue","headers","items","show-select"]))}}),Xa={class:"text-center"},Ya={class:"text-center"},Za={key:0,class:"text-disabled"},et={class:"text-center"},at={class:"mt-6 text-h5"},tt={class:"d-flex flex-wrap"},it={class:"mt-6 text-h5"},lt={key:0,class:"text-disabled"},nt={class:"mt-6 text-h5"},ot={key:2,class:"text-center"},st={class:"text-h5 mt-5"},_t=ee({__name:"PageBD",props:{id:{}},setup(I){const u=I,s=ve(),{mdAndUp:f}=he(),{isRtl:b}=ia(),{மொழியாக்கம்_பயன்படுத்து:x}=pe(),{$மொ:d}=x(),{அகராதியிலிருந்து_மொழிபெயர்ப்பு:_}=la(),{obtImageDéco:D}=da(),q=ja();na(()=>{q.documentOuvert({id:u.id,à:Date.now()})});const z=D("vide"),w=C(s.suivrePermission,{idObjet:u.id}),T=C(s.bds.suivreNomsBd,{idBd:u.id}),j=_(T),E=async c=>{const{àEffacer:p,àAjouter:i}=Pe({anciennes:T.value,nouvelles:c});for(const l of p)await s.bds.effacerNomBd({idBd:u.id,langue:l});await s.bds.sauvegarderNomsBd({idBd:u.id,noms:i})},W=C(s.bds.suivreDescriptionsBd,{idBd:u.id}),ae=_(W),M=async c=>{const{àEffacer:p,àAjouter:i}=Pe({anciennes:W.value,nouvelles:c});for(const l of p)await s.bds.effacerDescriptionBd({idBd:u.id,langue:l});await s.bds.sauvegarderDescriptionsBd({idBd:u.id,descriptions:i})},Ce=oa(C(s.bds.suivreImage,{idBd:u.id})),H=D("logoBD"),be=async c=>{c?await s.bds.sauvegarderImage({idBd:u.id,image:{contenu:new Uint8Array(c.contenu),nomFichier:c.fichier}}):await s.bds.effacerImage({idBd:u.id})},Q=C(s.bds.suivreStatutBd,{idBd:u.id}),se=C(s.bds.suivreVariablesBd,{idBd:u.id}),L=C(s.bds.suivreMotsClefsBd,{idBd:u.id}),ke=async c=>{const p=c.filter(l=>!L.value?.includes(l)),i=L.value?.filter(l=>!c.includes(l))||[];await s.bds.ajouterMotsClefsBd({idBd:u.id,idsMotsClefs:p}),await Promise.all(i.map(l=>s.bds.effacerMotClefBd({idBd:u.id,idMotClef:l})))},A=C(s.bds.suivreTableauxBd,{idBd:u.id}),te=O(()=>{if(A.value)return[...A.value].sort((c,p)=>c.id>p.id?-1:1)}),S=h();De(()=>{!S.value&&te.value?.length&&(S.value=te.value[0].clef),S.value&&!te.value?.map(c=>c.clef).includes(S.value)&&(S.value=void 0)});const P=h(!1),de=async({noms:c,cols:p})=>{P.value=!0;try{const i=await s.bds.ajouterTableauBd({idBd:u.id});await s.tableaux.sauvegarderNomsTableau({idTableau:i,noms:c}),await Promise.all(p.map(async l=>{await s.tableaux.ajouterColonneTableau({idTableau:i,idColonne:l.info.id,idVariable:l.info.variable}),l.info.index&&await s.tableaux.changerColIndex({idTableau:i,idColonne:l.info.id,val:!0}),await Promise.all(l.règles.map(async o=>await s.tableaux.ajouterRègleTableau({idTableau:i,idColonne:l.info.id,règle:o})))}))}finally{P.value=!1}},ue=C(s.réseau.suivreAuteursBd,{idBd:u.id}),ie=C(s.bds.suivreLicenceBd,{idBd:u.id}),J=C(s.bds.suivreLicenceContenuBd,{idBd:u.id}),U=async({licence:c,licenceContenu:p})=>{await s.bds.changerLicenceBd({idBd:u.id,licence:c}),p&&await s.bds.changerLicenceContenuBd({idBd:u.id,licenceContenu:p})},K=O(()=>[{title:d("navigation.données"),href:encodeURI("/données/")},{title:j.value||d("bds.sansNom"),disabled:!0}]),X=async()=>{await s.bds.effacerBd({idBd:u.id})};return(c,p)=>(r(),v(sa,null,{default:t(()=>[N("div",null,[a(f)?(r(),v(Na,{key:0,items:K.value,class:"pa-0"},{divider:t(()=>[e(F,null,{default:t(()=>[V(B(a(b)?"mdi-chevron-left":"mdi-chevron-right"),1)]),_:1})]),title:t(({item:i})=>[e(La,{disabled:i.disabled,onClick:l=>i.href&&c.$router.push(i.href)},{default:t(()=>[e(ua,{texte:i.title,"longueur-max":35},null,8,["texte"])]),_:2},1032,["disabled","onClick"])]),_:1},8,["items"])):(r(),v(g,{key:1,icon:"mdi-arrow-left-top",variant:"flat",onClick:p[0]||(p[0]=()=>c.$router.push(encodeURI("/données/")))}))]),e(ca,{"src-image":a(Ce),"img-defaut":a(H),editable:!!a(w),"taille-avatar":a(f)?275:175,"max-taille-image":a(ra),onImageChangee:p[1]||(p[1]=i=>be(i))},null,8,["src-image","img-defaut","editable","taille-avatar","max-taille-image"]),N("div",Xa,[e(Ee,{"etiquette-nom":a(d)("objet.étiquetteNom"),"indice-nom":a(d)("objet.indiceNom"),"indice-langue":a(d)("objet.indiceLangue"),"texte-aucun-nom":a(d)("objet.texteAucunNom"),"noms-initiaux":a(T),titre:a(d)("objet.titreDialogueNoms"),"sous-titre":a(d)("objet.sousTitreDialogueNoms"),"autorisation-modification":!!a(w),onAjusterNoms:E},{activator:t(({props:i})=>[N("span",y(i,{class:"text-h4"}),[V(B(a(j)||a(d)("bds.sansNom"))+" ",1),e(g,{icon:a(w)?"mdi-pencil":"mdi-earth",variant:"flat",size:"small"},null,8,["icon"])],16)]),_:1},8,["etiquette-nom","indice-nom","indice-langue","texte-aucun-nom","noms-initiaux","titre","sous-titre","autorisation-modification"]),e(ma,{id:c.id},null,8,["id"]),e(G)]),N("div",Ya,[e(Ie,{"n-max":5,items:a(L)},{jeton:t(({id:i})=>[e(Se,{id:i},{activator:t(({props:l})=>[e(fa,y(l,{id:i}),null,16,["id"])]),_:2},1032,["id"])]),itemListe:t(({id:i})=>[e(Se,{id:i},{activator:t(({props:l})=>[e(va,y(l,{id:i}),null,16,["id"])]),_:2},1032,["id"])]),_:1},8,["items"]),a(L)&&!a(L).length?(r(),ne("span",Za,B(a(d)("bds.aucunMotClef")),1)):$("",!0),a(w)&&a(L)?(r(),v(pa,{key:1,originaux:a(L),onSauvegarder:p[2]||(p[2]=i=>ke(i))},null,8,["originaux"])):$("",!0)]),N("div",et,[e(_a,{id:c.id},{activator:t(({props:i})=>[e(oe,{"open-delay":"200",location:"bottom",text:a(d)("épingler.épingler")},{activator:t(({props:l})=>[e(g,y({...i,...l},{icon:"",variant:"flat"}),{default:t(()=>[e(ba,{id:c.id},null,8,["id"])]),_:2},1040)]),_:2},1032,["text"])]),_:1},8,["id"]),e(Qe,{"id-objet":c.id,"type-objet":"bd"},{activator:t(({props:i})=>[e(oe,{text:a(d)("exportations.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:l})=>[e(g,y({...i,...l},{icon:"mdi-download",variant:"flat"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id-objet"]),e(Fa,{id:c.id},{activator:t(({props:i})=>[e(oe,{text:a(d)("code.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:l})=>[e(g,y({...i,...l},{icon:"mdi-xml",variant:"flat"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id"]),$("",!0),a(w)?(r(),v(ze,{key:1,onEffacer:X},{activator:t(({props:i})=>[e(oe,{"open-delay":"200",location:"bottom",text:a(d)("effacer.indice")},{activator:t(({props:l})=>[e(g,y({...i,...l},{variant:"flat",icon:""}),{default:t(()=>[e(F,{color:"error"},{default:t(()=>p[7]||(p[7]=[V("mdi-delete")])),_:1})]),_:2},1040)]),_:2},1032,["text"])]),_:1})):$("",!0)]),e(ce),e(fe,null,{default:t(()=>[e(Ee,{"etiquette-nom":a(d)("objet.étiquetteDescription"),"indice-nom":a(d)("objet.indiceDescription"),"indice-langue":a(d)("objet.indiceLangue"),"texte-aucun-nom":a(d)("objet.texteAucuneDescription"),"noms-initiaux":a(W),titre:a(d)("objet.titreDialogueDescriptions"),"sous-titre":a(d)("objet.sousTitreDialogueDescriptions"),"autorisation-modification":!!a(w),longue:"",onAjusterNoms:M},{activator:t(({props:i})=>[N("span",{class:ya({"text-disabled":!a(ae)})},B(a(ae)||a(d)("communs.baseCarteObjet.sansDescription")),3),e(g,y(i,{icon:a(w)?"mdi-pencil":"mdi-earth",variant:"flat",size:"small"}),null,16,["icon"])]),_:1},8,["etiquette-nom","indice-nom","indice-langue","texte-aucun-nom","noms-initiaux","titre","sous-titre","autorisation-modification"]),N("p",at,B(a(d)("bds.info")),1),e(ce,{class:"mb-2"}),N("div",tt,[a(Q)&&(a(Q).statut!=="active"||a(w))?(r(),v(R,{key:0,flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(Ga,{"id-bd":c.id},{activator:t(({props:i})=>[e(Pa,y(i,{"type-objet":"bd",statut:a(Q)}),null,16,["statut"])]),_:1},8,["id-bd"])]),_:1})):$("",!0),e(R,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(Qa,{"id-bd":c.id},{activator:t(({props:i})=>[e(Wa,y(i,{id:c.id}),null,16,["id"])]),_:1},8,["id-bd"])]),_:1}),e(R,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(ga,{id:c.id,auteurs:a(ue),"permission-moderateur":a(w)==="MODÉRATEUR"},{activator:t(({props:i})=>[e(Ua,y(i,{auteurs:a(ue)}),null,16,["auteurs"])]),_:1},8,["id","auteurs","permission-moderateur"])]),_:1}),e(R,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(Re,{licence:a(ie),"licence-contenu":a(J),"permission-modifier":a(w)==="MODÉRATEUR",onChangerLicence:U},{activator:t(({props:i})=>[e(Ha,y(i,{licence:a(ie),onChangerLicence:U}),null,16,["licence"])]),_:1},8,["licence","licence-contenu","permission-modifier"])]),_:1}),e(R,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(Oa,{id:c.id},{activator:t(({props:i})=>[e(Ma,y(i,{id:c.id}),null,16,["id"])]),_:1},8,["id"])]),_:1}),e(R,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(Fe,{"id-objet":c.id,permission:a(w),"type-objet":"bd"},{activator:t(({props:i})=>[e(Ra,y(i,{"id-objet":c.id}),null,16,["id-objet"])]),_:1},8,["id-objet","permission"])]),_:1})]),N("p",it,B(a(d)("bds.variables")),1),e(ce,{class:"mb-2"}),e(Ie,{"n-max":5,items:a(se)},{jeton:t(({id:i})=>[e(Ne,{id:i},{activator:t(({props:l})=>[e(xa,y(l,{id:i}),null,16,["id"])]),_:2},1032,["id"])]),itemListe:t(({id:i})=>[e(Ne,{id:i},{activator:t(({props:l})=>[e(Ba,y(l,{id:i}),null,16,["id"])]),_:2},1032,["id"])]),_:1},8,["items"]),a(se)?.length?$("",!0):(r(),ne("p",lt,B(a(d)("bds.aucuneVariable")),1)),e(Me,null,{default:t(()=>[N("p",nt,B(a(d)("bds.tableaux")),1),e(ce),a(f)?(r(),v(za,{key:0,modelValue:S.value,"onUpdate:modelValue":p[4]||(p[4]=i=>S.value=i),class:"mt-2"},{default:t(()=>[(r(!0),ne(we,null,me(a(A),i=>(r(),v(Ue,{key:i.clef,value:i.clef,color:"primary",size:"small"},{default:t(()=>[e(qa,{id:i.id,clef:i.clef},null,8,["id","clef"])]),_:2},1032,["value"]))),128)),e(Te,{onSauvegarder:de},{activator:t(({props:i})=>[a(w)?(r(),v(Ue,y({key:0},i,{"append-icon":P.value?void 0:"mdi-plus",disabled:P.value,variant:"tonal",class:"mx-1",label:"",onClick:p[3]||(p[3]=Ca(()=>{},["stop"]))}),{default:t(()=>[V(B(a(d)("tableaux.nouveau"))+" ",1),P.value?(r(),v(Z,{key:0,class:"ms-2",size:"15",width:"1",indeterminate:""})):$("",!0)]),_:2},1040,["append-icon","disabled"])):$("",!0)]),_:1})]),_:1},8,["modelValue"])):(r(),v(ka,{key:1,modelValue:S.value,"onUpdate:modelValue":p[5]||(p[5]=i=>S.value=i),class:"mt-4","show-arrows":"","center-active":""},{default:t(()=>[(r(!0),ne(we,null,me(a(A),i=>(r(),v(Oe,{key:i.clef,value:i.clef},{default:t(({isSelected:l,toggle:o})=>[e(Le,{class:"mx-1",variant:"tonal",label:"",active:!1,color:l?"primary":"",onClick:o},{default:t(()=>[V(B(i.clef.slice(0,10))+" ",1),e(F,{class:"ms-2",icon:"mdi-pencil",variant:"flat",size:"x-small"})]),_:2},1032,["color","onClick"])]),_:2},1032,["value"]))),128)),e(Oe,{key:"nouveau",value:"nouveau"},{default:t(()=>[e(Te,{onSauvegarder:de},{activator:t(({props:i})=>[a(w)?(r(),v(Le,y({key:0},i,{"append-icon":P.value?void 0:"mdi-plus",variant:"tonal",class:"mx-1",label:"",disabled:P.value}),{default:t(()=>[V(B(a(d)("tableaux.nouveau"))+" ",1),P.value?(r(),v(Z,{key:0,class:"ms-2",size:"15",width:"1",indeterminate:""})):$("",!0)]),_:2},1040,["append-icon","disabled"])):$("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])),a(A)&&!a(A).length?(r(),ne("div",ot,[N("p",st,B(a(d)("tableaux.aucun")),1),e(Va,{src:a(z),class:"my-5",contain:"",height:"175px"},null,8,["src"]),e(Te,{onSauvegarder:de},{activator:t(({props:i})=>[a(w)?(r(),v(g,y({key:0},i,{color:"primary",class:"mx-2",variant:"outlined"}),{prepend:t(()=>[e(F,{icon:"mdi-table",start:""})]),default:t(()=>[V(" "+B(a(d)("tableaux.nouveau")),1)]),_:2},1040)):$("",!0)]),_:1})])):$("",!0)]),_:1}),e(wa,{modelValue:S.value,"onUpdate:modelValue":p[6]||(p[6]=i=>S.value=i)},{default:t(()=>[(r(!0),ne(we,null,me(a(A),i=>(r(),v(Ta,{key:i.clef,value:i.clef},{default:t(()=>[e(Ka,{"id-tableau":i.id,"id-bd":c.id},null,8,["id-tableau","id-bd"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}))}});export{_t as default};
//# sourceMappingURL=PageBD-BMBYdPCB.js.map
